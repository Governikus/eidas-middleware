<!--
  ~ Copyright (c) 2020 Governikus KG. Licensed under the EUPL, Version 1.2 or as soon they will be approved by
  ~ the European Commission - subsequent versions of the EUPL (the "Licence"); You may not use this work except
  ~ in compliance with the Licence. You may obtain a copy of the Licence at:
  ~ http://joinup.ec.europa.eu/software/page/eupl Unless required by applicable law or agreed to in writing,
  ~ software distributed under the Licence is distributed on an "AS IS" basis, WITHOUT WARRANTIES OR CONDITIONS
  ~ OF ANY KIND, either express or implied. See the Licence for the specific language governing permissions and
  ~ limitations under the Licence.
  -->

<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="inputTextField(fieldName, message)">
    <div data-th-id="${fieldName} + 'Row'">
        <span data-th-if="${#fields.hasErrors('__${fieldName}__')}"
              data-th-errors="*{__${fieldName}__}">fieldName error</span>
        <label data-th-id="${fieldName} + 'Label'" data-th-for="${fieldName}">
            <span data-th-text="${message}">fieldName</span>
            <sup>*</sup>
        </label>
        <input data-th-id="${fieldName}" data-th-name="${fieldName}" name="fieldName"
               type="text" data-th-field="*{__${fieldName}__}"
        >
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="inputPasswordField(fieldName, message)">
    <div data-th-id="${fieldName} + 'Row'">
        <span data-th-if="${#fields.hasErrors('__${fieldName}__')}"
              data-th-errors="*{__${fieldName}__}">fieldName error</span>
        <label data-th-id="${fieldName} + 'Label'" data-th-for="${fieldName}">
            <span data-th-text="${message}">fieldName</span>
            <sup>*</sup>
        </label>
        <input data-th-id="${fieldName}" data-th-name="${fieldName}" name="fieldName"
               type="password" data-th-value="*{__${fieldName}__}"
        >
    </div>

</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="inputFileField(fieldName, message)">
    <div data-th-id="${fieldName} + 'Row'">
        <span data-th-if="${#fields.hasErrors('__${fieldName}__')}"
              data-th-errors="*{__${fieldName}__}">fieldName error</span>
        <label data-th-id="${fieldName} + 'Label'" data-th-for="${fieldName}">
            <span data-th-text="${message}">fieldName</span>
            <sup>*</sup>
        </label>
        <input data-th-id="${fieldName}" data-th-name="${fieldName}" name="fieldName"
               type="file" data-th-field="*{__${fieldName}__}"
        >
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="inputConfigFileField(fieldName, message)" class="table-cell">
    <label data-th-id="${fieldName} + 'Label'" data-th-for="${fieldName}">
        <span data-th-text="${message}">fieldName</span>
    </label>
    <input data-th-id="${fieldName}" data-th-name="${fieldName}" name="fieldName"
           type="file" data-th-field="*{__${fieldName}__}">
    <span data-th-if="${#fields.hasErrors('__${fieldName}__')}"
          data-th-errors="*{__${fieldName}__}" class="validation-error">fieldName error</span>
    <p data-th-unless="${#fields.hasErrors('__${fieldName}__')}"
       data-th-if="*{__${fieldName}__ != null && __${fieldName}__.size > 0}" class="success-message"
       data-th-text="*{'file ''' + __${fieldName}__.originalFilename + ''' was uploaded successfully'}">
    </p>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="textRow(fieldName, description)"
     class="table-row">
    <label class="table-cell description" data-th-text="${description}"></label>
    <span class="stretch table-cell" data-th-utext="${fieldName}"></span>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="dateRow(fieldName, description)"
     class="table-row">
    <label class="table-cell description" data-th-text="${description}"></label>
    <span class="table-cell" data-th-utext="${#dates.format(__${fieldName}__, 'dd.MMM.yyyy hh:mm:ss')}"></span>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="textInputRow(idBase, fieldName, description, message)"
     class="table-row">
    <label data-th-for="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
           class="table-cell description" data-th-text="${description}"></label>
    <div class="table-cell">
        <p data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName} + -error"
           data-th-if="${#fields.hasErrors('__${fieldName}__')}" data-th-errors="*{__${fieldName}__}"
           class="validation-error">
            fieldName error
        </p>
        <p data-th-unless="${#strings.isEmpty(message)}" data-th-utext="${message}"
           class="field-description-message"></p>
        <input data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
               class="text-area-input" type="text" data-th-field="*{__${fieldName}__}">
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="checkboxRow(idBase, fieldName, description, message)"
     class="table-row">
    <label data-th-for="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
           class="table-cell description" data-th-text="${description}"></label>
    <div class="table-cell">
        <p data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName} + -error"
           data-th-if="${#fields.hasErrors('__${fieldName}__')}" data-th-errors="*{__${fieldName}__}"
           class="validation-error">
            fieldName error
        </p>
        <p data-th-unless="${#strings.isEmpty(message)}" data-th-utext="${message}"
           class="field-description-message"></p>
        <input type="checkbox" data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
               data-th-field="*{__${fieldName}__}">
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="staticDropDownRow(idBase, fieldName, description, message, enumList)"
     class="table-row">
    <label data-th-for="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
           class="table-cell description" data-th-text="${description}"></label>
    <div class="table-cell">
        <p data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName} + -error"
           data-th-if="${#fields.hasErrors('__${fieldName}__')}" data-th-errors="*{__${fieldName}__}"
           class="validation-error">
            fieldName error
        </p>
        <p data-th-unless="${#strings.isEmpty(message)}" data-th-utext="${message}"
           class="field-description-message"></p>
		<select  data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
               data-th-field="*{__${fieldName}__}">
			<option th:each="state : ${enumList}"
				th:value="${state}" th:text="${state}"></option>
		</select>
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="passwordInputRow(idBase, fieldName, description, message)"
     class="table-row">
    <label data-th-for="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
           class="table-cell description" data-th-text="${description}"></label>
    <div class="table-cell">
        <p data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName} + -error"
           data-th-if="${#fields.hasErrors('__${fieldName}__')}" data-th-errors="*{__${fieldName}__}"
           class="validation-error">
            fieldName error
        </p>
        <p data-th-unless="${#strings.isEmpty(message)}" data-th-text="${message}"
           class="field-description-message"></p>
        <input data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
               class="text-area-input" type="password" data-th-value="*{__${fieldName}__}"
               data-th-name="${fieldName}">
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="passwordInputRowExtendedName(idBase, fieldName, description, message)"
     class="table-row">
    <label data-th-for="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
           class="table-cell description" data-th-text="${description}"></label>
    <div class="table-cell">
        <p data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName} + -error"
           data-th-if="${#fields.hasErrors('__${fieldName}__')}" data-th-errors="*{__${fieldName}__}"
           class="validation-error">
            fieldName error
        </p>
        <p data-th-unless="${#strings.isEmpty(message)}" data-th-text="${message}"
           class="field-description-message"></p>
        <input data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
               class="text-area-input" type="password" data-th-value="*{__${fieldName}__}"
               data-th-name="${idBase + '.' + fieldName}">
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="fileInputRow(fieldName, description, message)"
     class="table-row">
    <label data-th-for="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
           class="table-cell description" data-th-text="${description}"></label>
    <div class="table-cell">
        <p data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName} + -error"
           data-th-if="${#fields.hasErrors('__${fieldName}__')}" data-th-errors="*{__${fieldName}__}"
           class="validation-error">
            fieldName error
        </p>
        <p data-th-unless="${#strings.isEmpty(message)}" data-th-text="${message}"
           class="field-description-message"></p>
        <input data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName}"
               class="stretch" type="file" data-th-field="*{__${fieldName}__}">
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="certificate(certificate, alias)"
     data-th-if="${certificate != null}">

    <div class="table"
         data-th-with="validityDays=${certificate.remainingOrExceedingValidityDays},
                                 daysToWarning=30">
        <div class="table-row">
            <details class="table-cell">
                <summary data-th-if="${validityDays > daysToWarning}"
                         data-th-utext="'<strong>' +
                                                     ${certificate.certificateName} + ':</strong> ' + 'expires in ' +
                                                     ${#numbers.formatDecimal(validityDays,2,0)} + ' days'"></summary>

                <summary data-th-if="${validityDays >= 0 && validityDays < daysToWarning}"
                         data-th-utext="'<strong>' + ${certificate.certificateName} + ':</strong> '
                                                    + 'expires in ' + ${#numbers.formatDecimal(validityDays,2,0)}
                                                    + ' days'"
                         class="warning"></summary>

                <summary data-th-if="${validityDays < 0}"
                         data-th-utext="'<strong>' +
                                             ${certificate.certificateName} + ':</strong> ' + 'has expired for ' +
                                             ${#numbers.formatDecimal(validityDays * -1,2,0)} + ' days'"
                         class="error"></summary>
                <div class="table">
                    <div data-th-replace="fragments/view-components.html :: textRow(${certificate.issuer},
                                                                                      'issuer')"></div>
                    <div data-th-replace="fragments/view-components.html :: textRow(${certificate.subject},
                                                                                      'subject')"></div>
                    <div data-th-replace="fragments/view-components.html :: textRow(${certificate.serialnumber},
                                                                                      'serialnumber')"></div>
                    <div data-th-replace="fragments/view-components.html :: dateRow(certificate.notBefore,
                                                                                      'valid from')"></div>
                    <div data-th-replace="fragments/view-components.html :: dateRow(certificate.notAfter,
                                                                                      'valid until')"></div>
                    <div data-th-if="${alias != null}"
                         class="table-row"
                         data-th-include="fragments/view-components.html :: textRow(${alias},
                                                                                      alias)"></div>
                </div>
            </details>
        </div>
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="uploadCertificateForm()"
     class="table">

    <div data-th-replace="fragments/view-components.html :: textInputRow(
                                              idBase        = certificate,
                                              fieldName     = certificateName,
                                              description   = #{certificate.name},
                                              message       = #{certificate.message})"></div>
    <div data-th-replace="fragments/view-components.html :: fileInputRow(
                                              idBase        = certificate,
                                              fieldName     = certificateFile,
                                              description   = #{certificate.file},
                                              message       = null)"></div>
    <div class="table-row">
        <span class="table-cell"></span>
        <div class="table-cell">
            <button id="certificate-upload-button" class="gov-button position-right" type="submit" name="upload"
                    value="certificate" data-th-text="#{button.upload}">
            </button>
            <span id="certificateUploadSuccess" class="success-message"
                  data-th-if="${certificateUploadSuccess}"
                  data-th-text="#{wizard.status.upload.successful}"></span>
        </div>
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="uploadKeystoreForm()" class="table">

    <div
            data-th-replace="fragments/view-components.html :: textInputRow(
                                              idBase        = keystore,
                                              fieldName     = keystoreName,
                                              description   = #{keystore.name},
                                              message       = #{keystore.message})"></div>
    <div
            data-th-replace="fragments/view-components.html :: textInputRow(
                                              idBase        = keystore,
                                              fieldName     = alias,
                                              description   = #{keystore.alias},
                                              message       = #{keystore.alias.message})"></div>
    <div
            data-th-replace="fragments/view-components.html :: passwordInputRow(
                                              idBase        = keystore,
                                              fieldName     = keystorePassword,
                                              description   = #{keystore.password},
                                              message       = #{keystore.password.message})"></div>
    <div
            data-th-replace="fragments/view-components.html :: passwordInputRow(
                                              idBase        = keystore,
                                              fieldName     = privateKeyPassword,
                                              description   = #{keystore.private.password},
                                              message       = #{keystore.private.password.message})"></div>
    <div
            data-th-replace="fragments/view-components.html :: fileInputRow(
                                              idBase        = keystore,
                                              fieldName     = keystoreFile,
                                              description   = #{keystore.file},
                                              message       = #{keystore.file.message})"></div>
    <div class="table-row">
        <span class="table-cell"></span>
        <div class="table-cell">
            <button id="keystore-upload-button" class="gov-button position-right"
                    type="submit" name="upload" value="keystore" data-th-text="#{button.upload}">
            </button>
            <span data-th-if="${keystoreUploadSuccess}"
                  id="keystoreUploadSuccess" class="success-message"
                  data-th-text="#{wizard.status.upload.successful}"></span>
        </div>
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="certificateList()"
     data-th-each="certificate : ${certificateList}">
    <div data-th-replace="fragments/view-components.html :: certificate(${certificate}, null)"></div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="keystoreList()"
     data-th-each="keystore : ${keystoreList}">
    <div data-th-replace="fragments/view-components.html :: certificate(${keystore.asCertificate()}, ${keystore.alias})">
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="certificateSelection(description, certificateList, fieldName, message)"
     class="table-row"
     data-th-with="current_certificate=*{__${fieldName}__}">

    <span class="table-cell description" data-th-utext="${description}"></span>

    <div class="table-cell">

        <p data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName} + -error"
           data-th-if="${#fields.hasErrors('__${fieldName}__') and not #lists.isEmpty(certificateList)}"
           data-th-errors="*{__${fieldName}__}"
           class="validation-error">
            fieldName error
        </p>

        <p data-th-unless="${#strings.isEmpty(message)}" data-th-text="${message}"
           class="field-description-message"></p>
        <select data-th-field="*{__${fieldName}__}"
                data-th-unless="${#lists.isEmpty(certificateList)}">

            <option value="0"></option>
            <option data-th-each="certificate : ${certificateList}"
                    data-th-value="${certificate.name}"
                    data-th-utext="${certificate.name}"
                    data-th-selected="${#strings.equals((current_certificate != null ? current_certificate.name : null),
                                                   certificate.name)}"
            ></option>

        </select>

        <p data-th-if="${#lists.isEmpty(certificateList)}"
           class="warning" data-th-text="#{wizard.status.warning.no.certs}"/>

        <data-th-block data-th-if="*{__${fieldName}__ != null}">
            <div data-th-replace="fragments/view-components.html :: certificate(*{__${fieldName}__}, null)"></div>
        </data-th-block>
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="keystoreSelection(description, keystoreList, fieldName, message)"
     class="table-row"
     data-th-with="current_keystore=*{__${fieldName}__}">

    <span class="table-cell description" data-th-utext="${description}"></span>

    <div class="table-cell">

        <p data-th-id="${#strings.isEmpty(idBase) ? '' : idBase + '-'} + ${fieldName} + -error"
           data-th-if="${#fields.hasErrors('__${fieldName}__') and not #lists.isEmpty(keystoreList)}"
           data-th-errors="*{__${fieldName}__}"
           class="validation-error">
            fieldName error
        </p>

        <p data-th-unless="${#strings.isEmpty(message)}" data-th-text="${message}"
           class="field-description-message"></p>
        <select data-th-field="*{__${fieldName}__}"
                data-th-unless="${#lists.isEmpty(keystoreList)}">

            <option value="0"></option>
            <option data-th-each="keystore : ${keystoreList}"
                    data-th-value="${keystore.name}"
                    data-th-utext="${keystore.name}"
                    data-th-selected="${#strings.equals((current_keystore != null ? current_keystore.name : null),
                                                   keystore.name)}"
            ></option>

        </select>

        <p data-th-if="${#lists.isEmpty(keystoreList)}"
           data-th-text="#{wizard.status.warning.no.keystores}"
           class="warning"/>

        <data-th-block data-th-if="*{__${fieldName}__ != null}">
            <div data-th-replace="fragments/view-components.html :: certificate(*{__${fieldName}__.asCertificate()},
                                                                          *{__${fieldName}__.alias})"></div>
        </data-th-block>
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="keystoreSelectionWithoutValidation(description, keystoreList, fieldName)"
     class="table-row"
     data-th-with="current_keystore=*{__${fieldName}__}">

    <span class="table-cell description" data-th-utext="${description}"></span>

    <div class="table-cell">
        <select data-th-field="*{__${fieldName}__}"
                data-th-unless="${#lists.isEmpty(keystoreList)}">

            <option value="0" selected></option>
            <option data-th-each="keystore : ${keystoreList}"
                    data-th-value="${keystore.name}"
                    data-th-utext="${keystore.name}"
                    data-th-selected="${#strings.equals((current_keystore != null ? current_keystore.name : null),
                                                   keystore.name)}"
            ></option>

        </select>

        <p data-th-if="${#lists.isEmpty(keystoreList)}"
           data-th-text="#{wizard.status.warning.no.keystores}"
           class="warning"/>

        <data-th-block data-th-if="*{__${fieldName}__ != null}">
            <div data-th-replace="fragments/view-components.html :: certificate(*{__${fieldName}__.asCertificate()},
                                                                          *{__${fieldName}__.alias})"></div>
        </data-th-block>
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
<div data-th-fragment="radioButtonPolicyImplementation(fieldName, message)"
     class="table-row">
    <p class="table-cell description">DVCA</p>
    <div class="table-cell">
        <p data-th-id="${fieldName} + -error"
           data-th-if="${#fields.hasErrors('__${fieldName}__')}"
           data-th-errors="*{__${fieldName}__}"
           class="validation-error">fieldName error</p>
        <p data-th-unless="${#strings.isEmpty(message)}" data-th-text="${message}"
           class="field-description-message"></p>
        <p>
            <span>Bundesdruckerei</span>
            <input type="radio" data-th-field="*{__${fieldName}__}"
                   data-th-value="${T(de.governikus.eumw.configuration.wizard.web.model.poseidasxml.DvcaProvider).BUDRU}"/>
        </p>
        <p>
            <span>Governikus</span>
            <input type="radio" data-th-field="*{__${fieldName}__}"
                   data-th-value="${T(de.governikus.eumw.configuration.wizard.web.model.poseidasxml.DvcaProvider).GOV_DVCA}"/>
        </p>
        <p>
            <span>Governikus (New)</span>
            <input type="radio" data-th-field="*{__${fieldName}__}"
                   data-th-value="${T(de.governikus.eumw.configuration.wizard.web.model.poseidasxml.DvcaProvider).NEW_GOV_DVCA}"/>
        </p>
    </div>
</div>
<!-- -------------------------------------------------------------------------------------------------------------- -->
